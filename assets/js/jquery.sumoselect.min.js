/*!
 * jquery.sumoselect
 * Last modified: 2021/08/11 10:15:09
 * 
 * Version: 3.3.28
 * http://hemantnegi.github.io/jquery.sumoselect
 * 2016-12-12
 * modified by Christoph Amthor
 *
 * Copyright 2015 Hemant Negi
 * Email : hemant.frnz@gmail.com
 * Compressor http://refresh-sf.com/
 */
!function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):"undefined"!=typeof exports?module.exports=factory(require("jquery")):factory(jQuery)}($=>{$.fn.SumoSelect=function(options){const dispatchEvent=(target,eventName)=>{let event;"function"==typeof Event?event=new Event(eventName):(event=document.createEvent("Event"),event.initEvent(eventName,!0,!0)),target.dispatchEvent(event)};window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);const defaultOptions={placeholder:"Select Here",csvDispCount:3,captionFormat:"{0} Selected",captionFormatAllSelected:"{0} all selected!",floatWidth:400,forceCustomRendering:!1,nativeOnDevice:["Android","BlackBerry","iPhone","iPad","iPod","Opera Mini","IEMobile","Silk"],outputAsCSV:!1,csvSepChar:",",okCancelInMulti:!1,isClickAwayOk:!1,triggerChangeCombined:!0,selectAll:!1,search:!1,searchText:"Search...",searchFn:(haystack,needle)=>haystack.toLowerCase().indexOf(needle.toLowerCase())<0,noMatch:'No matches for "{0}"',prefix:"",locale:["OK","Cancel","Select All"],up:!1,showTitle:!0,max:null,renderLi:(li,_originalOption)=>li},ret=this.each((function(){const selObj=this;if(this.sumo||!$(this).is("select"))return;const settings=$.extend({},defaultOptions,options,$(this).data());this.sumo={E:$(selObj),is_multi:$(selObj).attr("multiple"),select:"",caption:"",placeholder:"",optDiv:"",CaptionCont:"",ul:"",is_floating:!1,is_opened:!1,mob:!1,Pstate:[],lastUnselected:null,selectedCount:0,createElems(){const O=this,selectedOptions=O.E.find("option:checked");O.E.wrap('<div class="SumoSelect" tabindex="0" role="button" aria-expanded="false">'),selectedOptions.each((_,selectedOption)=>{selectedOption.selected=!0}),O.select=O.E.parent(),O.caption=$("<span>"),O.CaptionCont=$(`<p class="CaptionCont SelectBox ${O.E.attr("class")}" ><label><i></i></label></p>`).attr("style",O.E.attr("style")).prepend(O.caption),O.select.append(O.CaptionCont),O.is_multi||(settings.okCancelInMulti=!1),O.E.attr("disabled")&&O.select.addClass("disabled").removeAttr("tabindex"),settings.outputAsCSV&&O.is_multi&&O.E.attr("name")&&(O.select.append($('<input class="HEMANT123" type="hidden" />').attr("name",O.E.attr("name")).val(O.getSelStr())),O.E.removeAttr("name")),!O.isMobile()||settings.forceCustomRendering?(O.E.attr("name")&&O.select.addClass(`sumo_${O.E.attr("name").replace(/\[\]/,"")}`),O.E.addClass("SumoUnder").attr("tabindex","-1"),O.optDiv=$(`<div class="optWrapper ${settings.up?"up":""}">`),O.floatingList(),O.ul=$('<ul class="options">'),O.optDiv.append(O.ul),settings.selectAll&&O.is_multi&&!settings.max&&O.SelAll(),settings.search&&O.Search(),O.ul.append(O.prepItems(O.E.children())),O.is_multi&&O.multiSelelect(),O.select.append(O.optDiv),O._handleMax(),O.basicEvents(),O.selAllState()):O.setNativeMobile()},prepItems(opts,d){const lis=[],O=this;return $(opts).each((i,opt)=>{const $opt=$(opt);lis.push($opt.is("optgroup")?$(`<li class="group ${opt.disabled?"disabled":""}"><label></label><ul></ul></li>`).find("label").text($opt.attr("label")).end().find("ul").append(O.prepItems($opt.children(),opt.disabled)).end():O.createLi($opt,d))}),lis},createLi(opt,d){const O=this;opt.attr("value")||opt.attr("value",opt.val());const li=$(`<li class="opt"><label>${opt.html()}</label></li>`);return li.data("opt",opt),opt.data("li",li),O.is_multi&&li.prepend("<span><i></i></span>"),(opt[0].disabled||d)&&li.addClass("disabled"),O.onOptClick(li),opt[0].selected&&(li.addClass("selected"),O.selectedCount++),opt.attr("class")&&li.addClass(opt.attr("class")),opt.attr("title")&&li.attr("title",opt.attr("title")),settings.renderLi(li,opt)},getSelStr(){const sopt=[];return this.E.find("option:checked").each((function(){sopt.push($(this).val())})),sopt.join(settings.csvSepChar)},multiSelelect(){const O=this;O.optDiv.addClass("multiple"),O.okbtn=$('<p tabindex="0" class="btnOk"></p>').click(()=>{O._okbtn(),O.hideOpts()}),[O.okbtn[0].innerText]=settings.locale,O.cancelBtn=$('<p tabindex="0" class="btnCancel"></p>').click(()=>{O._cnbtn(),O.hideOpts()}),[,O.cancelBtn[0].innerText]=settings.locale;const btns=O.okbtn.add(O.cancelBtn);O.optDiv.append($('<div class="MultiControls">').append(btns)),btns.on("keydown.sumo",(function(e){const el=$(this);switch(e.which){case 32:case 13:el.trigger("click");break;case 9:if(el.hasClass("btnOk"))return;break;case 27:return O._cnbtn(),void O.hideOpts()}e.stopPropagation(),e.preventDefault()}))},_okbtn(){const O=this;let cg=0;settings.triggerChangeCombined&&(O.E.find("option:checked").length!==O.Pstate.length?cg=1:O.E.find("option").each((i,e)=>{e.selected&&O.Pstate.indexOf(i)<0&&(cg=1)}),cg&&(O.callChange(),O.setText()))},_cnbtn(){const O=this;O.E.find("option:checked").each((function(){this.selected=!1})),O.optDiv.find("li.selected").removeClass("selected");for(let i=0;i<O.Pstate.length;i++)O.E.find("option")[O.Pstate[i]].selected=!0,O.ul.find("li.opt").eq(O.Pstate[i]).addClass("selected");O.selAllState()},_handleMax(){settings.max&&(this.selectedCount>=+settings.max?this.optDiv.find("li.opt").not(".hidden").each((ix,e)=>{$(e).hasClass("selected")||$(e).addClass("temporary-disabled disabled")}):this.optDiv.find("li.opt").not(".hidden").each((ix,e)=>{$(e).hasClass("temporary-disabled")&&$(e).removeClass("temporary-disabled disabled")}))},SelAll(){const O=this;O.is_multi&&(O.selAll=$('<p class="select-all"><span><i></i></span><label></label></p>'),[,,O.selAll.find("label")[0].innerText]=settings.locale,O.optDiv.addClass("selall"),O.selAll.on("click",()=>{O.selAll.toggleClass("selected"),O.toggSelAll(O.selAll.hasClass("selected"),1)}),O.optDiv.prepend(O.selAll))},Search(){const O=this,cc=O.CaptionCont.addClass("search"),P=$('<p class="no-match">'),fn=options.searchFn&&"function"==typeof options.searchFn?options.searchFn:settings.searchFn;O.ftxt=$('<input type="text" class="search-txt" value="" autocomplete="off">').on("click",e=>{e.stopPropagation()}),O.ftxt.placeholder=settings.searchText,cc.append(O.ftxt),O.optDiv.children("ul").after(P),O.ftxt.on("keyup.sumo",()=>{const hid=O.optDiv.find("ul.options li.opt").each((ix,e)=>{const el=$(e),{0:opt}=el.data("opt");opt.hidden=fn(el.text(),O.ftxt.val(),el),el.toggleClass("hidden",opt.hidden)}).not(".hidden");O.optDiv[0].querySelectorAll("li.group").forEach(optGroup=>{optGroup.querySelector("li:not(.hidden)")?optGroup.classList.remove("hidden"):optGroup.classList.add("hidden")}),P.html(settings.noMatch.replace(/\{0\}/g,"<em></em>")).toggle(!hid.length),P.find("em").text(O.ftxt.val()),O.selAllState()})},selAllState(){const O=this;if(settings.selectAll&&O.is_multi){let sc=0,vc=0;O.optDiv.find("li.opt").not(".hidden .disabled").each((ix,e)=>{$(e).hasClass("selected")&&sc++,vc++}),sc===vc?O.selAll.removeClass("partial").addClass("selected"):0===sc?O.selAll.removeClass("selected partial"):O.selAll.addClass("partial")}},showOpts(){const O=this;if(!O.E.attr("disabled")){if(O.E.trigger("sumo:opening",O),O.is_opened=!0,O.select.addClass("open").attr("aria-expanded","true"),O.E.trigger("sumo:opened",O),O.ftxt?O.ftxt.focus():O.select.focus(),$(document).on("click.sumo",e=>{if(!O.select.is(e.target)&&0===O.select.has(e.target).length){if(!O.is_opened)return;O.hideOpts(),settings.okCancelInMulti&&(settings.isClickAwayOk?O._okbtn():O._cnbtn())}}),O.is_floating){let H=O.optDiv.children("ul").outerHeight()+2;O.is_multi&&(H+=+O.optDiv.css("padding-bottom")),O.optDiv.css("height",H),$("body").addClass("sumoStopScroll")}O.setPstate()}},setPstate(){const O=this;O.is_multi&&(O.is_floating||settings.okCancelInMulti)&&(O.Pstate=[],O.E.find("option").each((i,e)=>{e.selected&&O.Pstate.push(i)}))},callChange(){this.E.trigger("change").trigger("click")},hideOpts(){const O=this;O.is_opened&&(O.E.trigger("sumo:closing",O),O.is_opened=!1,O.select.removeClass("open").attr("aria-expanded","false").find("ul li.sel").removeClass("sel"),O.E.trigger("sumo:closed",O),$(document).off("click.sumo"),$("body").removeClass("sumoStopScroll"),settings.search&&(O.ftxt.val(""),O.ftxt.trigger("keyup.sumo")))},setOnOpen(){const O=this;let li=O.optDiv.find("li.opt:not(.hidden)").eq(settings.search?0:O.E[0].selectedIndex);li.hasClass("disabled")&&(li=li.next(":not(disabled)"),!li.length)||(O.optDiv.find("li.sel").removeClass("sel"),li.addClass("sel"),O.showOpts())},nav(up){const O=this;let c=null,sel=O.ul.find("li.opt.sel:not(.hidden)");const s=O.ul.find("li.opt:not(.disabled):not(.hidden)"),idx=s.index(sel);if(O.is_opened&&sel.length){if(up&&idx>0)c=s.eq(idx-1);else{if(!(!up&&idx<s.length-1&&idx>-1))return;c=s.eq(idx+1)}sel.removeClass("sel"),sel=c.addClass("sel");const{ul:ul}=O,st=ul.scrollTop(),t=sel.position().top+st;t>=st+ul.height()-sel.outerHeight()&&ul.scrollTop(t-ul.height()+sel.outerHeight()),t<st&&ul.scrollTop(t)}else O.setOnOpen()},basicEvents(){const O=this;O.CaptionCont.click(evt=>{O.E.trigger("click"),O.is_opened?O.hideOpts():O.showOpts(),evt.stopPropagation()}),O.select.on("keydown.sumo",e=>{switch(e.which){case 38:O.nav(!0);break;case 40:O.nav(!1);break;case 65:if(O.is_multi&&!settings.max&&e.ctrlKey){O.toggSelAll(!e.shiftKey,1);break}return;case 32:if(settings.search&&O.ftxt.is(e.target))return;break;case 13:O.is_opened?O.optDiv.find("ul li.sel").trigger("click"):O.setOnOpen();break;case 9:return void(settings.okCancelInMulti||O.hideOpts());case 27:return settings.okCancelInMulti&&O._cnbtn(),void O.hideOpts();default:return}e.preventDefault()}),$(window).on("resize.sumo",()=>{O.floatingList()})},onOptClick(li){const O=this;li.click((function(){const $li=$(this);$li.hasClass("disabled")||(O.is_multi?($li.toggleClass("selected"),$li.data("opt")[0].selected=$li.hasClass("selected"),!1===$li.data("opt")[0].selected?(O.lastUnselected=$li.data("opt")[0].textContent,O.selectedCount--):O.selectedCount++,settings.max&&O._handleMax(),O.selAllState()):($li.parent().find("li.selected").removeClass("selected"),$li.toggleClass("selected"),$li.data("opt")[0].selected=!0,O.selectedCount=1),O.is_multi&&settings.triggerChangeCombined&&(O.is_floating||settings.okCancelInMulti)||(O.setText(),O.callChange()),O.is_multi||O.hideOpts())}))},setText(){const O=this;if(O.placeholder="",O.is_multi){const sels=O.E.find(":checked").not(":disabled");settings.csvDispCount&&sels.length>settings.csvDispCount?sels.length===O.E.find("option").length&&settings.captionFormatAllSelected?O.placeholder=settings.captionFormatAllSelected.replace(/\{0\}/g,sels.length):O.placeholder=settings.captionFormat.replace(/\{0\}/g,sels.length):O.placeholder=sels.toArray().map(selected=>selected.innerText).join(", ")}else O.placeholder=O.E.find(":checked").not(":disabled").text();let is_placeholder=!1;O.placeholder||(is_placeholder=!0,O.placeholder=O.E.attr("placeholder"),O.placeholder||(O.placeholder=O.E.find("option:disabled:checked").text())),O.placeholder=O.placeholder?`${settings.prefix} ${O.placeholder}`:settings.placeholder,O.caption.text(O.placeholder),settings.showTitle&&O.CaptionCont.attr("title",O.placeholder);const csvField=O.select.find("input.HEMANT123");return csvField.length&&csvField.val(O.getSelStr()),is_placeholder?O.caption.addClass("placeholder"):O.caption.removeClass("placeholder"),O.placeholder},isMobile(){const ua=navigator.userAgent||navigator.vendor||window.opera;for(let i=0;i<settings.nativeOnDevice.length;i++)if(ua.toString().toLowerCase().indexOf(settings.nativeOnDevice[i].toLowerCase())>0)return settings.nativeOnDevice[i];return!1},setNativeMobile(){const O=this;O.E.addClass("SelectClass"),O.mob=!0,O.E.change(()=>{O.setText()})},floatingList(){const O=this;O.is_floating=$(window).width()<=settings.floatWidth,O.optDiv.toggleClass("isFloating",O.is_floating),O.is_floating||O.optDiv.css("height",""),O.optDiv.toggleClass("okCancelInMulti",settings.okCancelInMulti&&!O.is_floating)},vRange(i){const O=this,opts=O.E.find("option");if(opts.length<=i||i<0)throw new Error("index out of bounds");return O},toggSel(c,i){const O=this;let opt=null;"number"==typeof i?(O.vRange(i),opt=O.E.find("option")[i]):opt=O.E.find(`option[value="${i}"]`)[0]||0,opt&&!opt.disabled&&opt.selected!==c&&(settings.max&&!opt.selected&&O.selectedCount<settings.max||opt.selected||!settings.max&&!opt.selected)&&(opt.selected=c,O.mob||$(opt).data("li").toggleClass("selected",c),O.callChange(),O.setPstate(),O.setText(),O.selAllState())},toggDis(c,i){const O=this.vRange(i);O.E.find("option")[i].disabled=c,c&&(O.E.find("option")[i].selected=!1),O.mob||O.optDiv.find("ul.options li.opt").eq(i).toggleClass("disabled",c).removeClass("selected"),O.setText()},toggSumo(val){const O=this;return O.enabled=val,O.select.toggleClass("disabled",val),val?(O.E.attr("disabled","disabled"),O.select.removeAttr("tabindex")):(O.E.removeAttr("disabled"),O.select.attr("tabindex","0")),O},toggSelAll(c,direct){const O=this,cloneOriginalEvents=$.extend(!0,{},$._data(O.E.get(0),"events"));O.E.off(),O.is_multi?c?O.E.find("option:not(:checked):not(:disabled):not(:hidden)").toArray().forEach(option=>{$(option).data("li").hasClass("hidden")||(option.selected=!0,$(option).data("li").toggleClass("selected",!0))}):O.E.find("option:checked:not(:disabled):not(:hidden)").toArray().forEach(option=>{$(option).data("li").hasClass("hidden")||(option.selected=!1,$(option).data("li").toggleClass("selected",!1))}):c?console.warn("You called `SelectAll` on a non-multiple select"):O.E[0].selectedIndex=-1,$.each(cloneOriginalEvents,(_,e)=>{$.each(e,(__,ev)=>{O.E.on(ev.type,ev.handler)})}),(O.is_multi&&!settings.okCancelInMulti||!O.is_multi)&&(O.callChange(),O.setText()),direct||(!O.mob&&O.selAll&&O.selAll.removeClass("partial").toggleClass("selected",!!c),O.setText(),O.setPstate())},reload(){const elm=this.unload();return $(elm).SumoSelect(settings)},unload(){const O=this;return O.select.before(O.E),O.E.show(),O.E[0].classList.remove("SumoUnder"),settings.outputAsCSV&&O.is_multi&&O.select.find("input.HEMANT123").length&&O.E.attr("name",O.select.find("input.HEMANT123").attr("name")),O.select.remove(),delete selObj.sumo,O.E.trigger("sumo:unloaded",O),selObj},add(val,txt,i,attr){if(void 0===val)throw new Error("No value to add");const O=this,opts=O.E.find("option");let value=val,text=txt,index=i;"number"==typeof txt?(index=txt,text=val):void 0===txt&&(text=val);const opt=$("<option></option>").val(value).html(text);if(attr&&"object"==typeof attr&&$.each(attr,(j,v)=>{opt.attr(j,v)}),opts.length<index)throw new Error("index out of bounds");return void 0===index||opts.length===index?(O.E.append(opt),O.mob||O.ul.append(O.createLi(opt))):(opts.eq(index).before(opt),O.mob||O.ul.find("li.opt").eq(index).before(O.createLi(opt))),selObj},remove(i){const O=this.vRange(i);O.E.find("option").eq(i).remove(),O.mob||O.optDiv.find("ul.options li.opt").eq(i).remove(),O.setText()},removeAll(){const O=this,optionList=O.E.find("option");for(let x=optionList.length-1;x>=0;x--)!0!==optionList[x].selected&&O.remove(x)},find(val){const O=this,optionList=O.E.find("option");for(let x in optionList)if(optionList[x].value===val)return+x;return-1},selectItem(i){this.toggSel(!0,i)},unSelectItem(i){this.toggSel(!1,i)},selectAll(){this.toggSelAll(!0)},unSelectAll(){this.toggSelAll(!1)},disableItem(i){this.toggDis(!0,i)},enableItem(i){this.toggDis(!1,i)},enabled:!0,enable(){return this.toggSumo(!1)},disable(){return this.toggSumo(!0)},init(){const O=this;return O.createElems(),O.setText(),O.E.trigger("sumo:initialized",O),O}},selObj.sumo.init()}));return 1===ret.length?ret[0]:ret}});